# Asset Organization

Theme-aware images, build output structure, and font references.

---

### Theme-Aware Image Paths

**Light Mode** (`/public/assets/light/`):
- `hero.webp`: Hero section background
- `ceremony.webp`: Ceremony event image
- `reception.webp`: Reception event image
- `travel.webp`: Travel/accommodations section image
- `registry.webp`: Gift registry section image
- `rsvp.webp`: RSVP section image

**Dark Mode** (`/public/assets/dark/`):
- `herodark.webp`: Dark hero section background
- `ceremonydark.webp`: Dark ceremony event image
- `receptiondark.webp`: Dark reception event image
- `traveldark.webp`: Dark travel/accommodations image
- `registrydark.webp`: Dark gift registry image
- `rsvpdark.webp`: Dark RSVP section image

**Usage**:
- Views use `renderThemePicture()` helper to generate `<picture>` elements with media queries
- CSS media query: `(prefers-color-scheme: dark)`
- Fallback: Light mode image for browsers without `<picture>` support
- Format: WebP for optimal compression and quality

**Naming Convention**:
- Light mode: `{section}.webp`
- Dark mode: `{section}dark.webp`

---

### Build Output Structure

**Location**: `/public/build/` (generated, not committed)

**Files**:
- `enhance.js`: Vite-built React bundle with code splitting
- `enhance.css`: Minified Tailwind CSS with purged unused styles
- `*.map`: Source maps for debugging (production)
- `assets/*`: Chunked JavaScript modules from code splitting

**Build Process**:
1. `npm run prebuild`: Cleans `/public/build` directory
2. `npm run build:css`: Compiles and minifies Tailwind CSS
3. `npm run build:js`: Builds React app with Vite

**Production Optimizations**:
- Tree-shaking: Removes unused code
- Minification: Compresses JavaScript and CSS
- Code splitting: Chunks by route/component
- Asset hashing: Cache-busting filenames (e.g., `enhance.abc123.js`)

**Dev Mode**:
- `npm run dev`: Watches files and rebuilds on change
- Vite HMR: Hot module replacement for fast iteration
- Source maps: Full debugging support

---

### Font References

**System Font Stack** (defined in `src/lib/pageStyles.ts`):
```css
font-family: 
  -apple-system, 
  BlinkMacSystemFont, 
  "Segoe UI", 
  Roboto, 
  "Helvetica Neue", 
  Arial, 
  sans-serif, 
  "Apple Color Emoji", 
  "Segoe UI Emoji", 
  "Segoe UI Symbol";
```

**Rationale**:
- No external font loading (performance, privacy)
- Native system fonts for optimal rendering
- Emoji support included
- Cross-platform consistency

**Monospace Stack** (for code snippets, if needed):
```css
font-family: 
  "SF Mono", 
  Monaco, 
  "Cascadia Code", 
  "Roboto Mono", 
  Consolas, 
  "Courier New", 
  monospace;
```

**Adobe Fonts** (optional, if configured):
- Tailwind config includes `https://use.typekit.net` in CSP

---

### Static Assets

**Root Level** (`/public/`):
- `index.html`: Landing page for unauthenticated visitors
- `main.css`: Hand-written CSS for landing page
- `theme-toggle.js`: Client-side theme toggle script
- `logo.webp`: Light mode logo/emblem
- `logodark.webp`: Dark mode logo/emblem
- `favicon.ico`: Browser tab icon (ICO format for sharp rendering at all sizes)
- `robots.txt`: Search engine directives (disallows all crawlers)
- `_headers`: Cloudflare Pages header configuration

**Build Output** (`/public/build/`):
- Generated by Vite and Tailwind
- Excluded from git via `.gitignore`
- Cleaned before each build via `npm run prebuild`

---

### Cache Strategy

**Static Assets**:
- `Cache-Control: public, max-age=31536000` (1 year)
- Asset hashing ensures cache invalidation on updates
- Immutable assets can be cached indefinitely

**Dynamic Routes**:
- `Cache-Control: no-store` for sensitive routes
- `/event`, `/admin`, `/auth/verify`, `/rsvp`, `/stripe/*`
- `X-Robots-Tag: noindex, nofollow` to prevent search indexing

**CSP Headers**:
- Middleware injects unique nonce per request
- `Content-Security-Policy` header with nonce-based script/style allowlist
- Prevents inline script execution without nonce